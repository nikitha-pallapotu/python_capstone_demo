pipeline {
    agent any 
	stages {
     stage('git clone') {
        steps {
            git branch: 'main',
                credentialsId: 'Github',
                url: 'https://github.com/nikitha-pallapotu/python_capstone_demo.git'
        }
	}
	 stage('sonar analysis') {
	   steps{
	       script{
	          bat '''
			    cd python-microservices
		        call sonar.bat
			   
			   '''
           }
        }
    }
      stage('pushing docker image for service1'){
        steps{
            script{
                bat '''
				    cd python-microservices/service1
                    docker build -t nikithap/service1:$BUILD_NUMBER .	
                    docker push nikithap/service1:$BUILD_NUMBER
                    '''	
				}	
            }
        }
	  stage('pushing docker image for service2'){
        steps{
            script{
                bat '''
				    cd python-microservices/service2
                    docker build -t nikithap/service2:$BUILD_NUMBER .	
                    docker push nikithap/service2:$BUILD_NUMBER
                    '''	
				}	
            }
        }	
	
    }
}

	
